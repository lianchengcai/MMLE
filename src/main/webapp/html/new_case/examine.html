<html>
<head>
    <title>待审批违规列表</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script language="javascript" src="../../script/jquery.js"></script>
    <script language="javascript" src="../../script/pageCommon.js" charset="utf-8"></script>
    <script language="javascript" src="../../script/PageUtils.js" charset="utf-8"></script>
    <script language="javascript" src="../../script/DemoData.js" charset="utf-8"></script>
    <script language="javascript" src="../../script/DataShowManager.js" charset="utf-8"></script>
    <link type="text/css" rel="stylesheet" href="../../style/blue/pageCommon.css" />
    <script type="text/javascript">
    
    function getUser(){
        var user = new Object();
      	 $.ajax({
      		 async: false, 
   		 type: "POST",
   		 url: "http://127.0.0.1:8082/mmle/login/session.do",
   		 dataType:"json",
   		 contentType: "application/json;charset=utf-8",
   		 success: function(data){
   			 var u = data['user'];
   			 user.account = u.account;
   			 user.name = u.name;
   			 user.roleId=u.role.roleId;
   	   },
   	    error:function(msg){alert("服务器未正常响应，请重试"+msg);}
   	});  
   	return user;
       }
    
    function getPage(currentPage){
    	var map={};
    	var fb = new Object(); 
    	var user = new Object();
    	user = getUser();  
    	 if(user.roleId==3){
			fb.state=1
		}
		if(user.roleId==4){
			fb.state=2
		}
		if(user.roleId==5){
			fb.state=3
		} 
    	map.lawEnMessage=fb;
    	map.currentPage=currentPage;
		if(user.roleId !=1 && user.roleId !=2){
		 $.ajax({
		 type: "POST",
		 url: "http://127.0.0.1:8082/mmle/lawEnforcement/getPage.do",
		 dataType:"json",
		 contentType: "application/json;charset=utf-8",
		 data: JSON.stringify(map),
		 success: function(data){
			 var html="";
			 var lawEnMessagePage = data['lawEnMessagePage'];
			 var pageSize = lawEnMessagePage.pageSize;
			 var pageIndex = lawEnMessagePage.pageIndex;
			 document.getElementById("pageSize").value =pageSize;
			 document.getElementById("currentPage").innerHTML =pageIndex;
			 if(lawEnMessagePage!=null){
			 var obj = eval(lawEnMessagePage['list']);
			 if(obj!=null){
				 for(var i=0;i<obj.length;i++){
			        	html+=("<tr class='TableDetail1 template'>"); 
			            html+=("<td>"+obj[i].id+"</td>");
			            html+=("<td>"+obj[i].casName+"</td>");
			            html+=("<td>"+obj[i].caseName+"</td>");
			            html+=("<td><a href='examine_info.html?id="+obj[i].id+"'>审批</a></td>");
		                html+=("</tr>"); 
			        }
			        
				 }
			        document.getElementById("TableData").innerHTML=html;
			 }
			 },error:function(){alert("服务器未正常响应，请重试");}
	});  
		}
}
    
    function firstPage(){
   		var currentPage = document.getElementById("currentPage").innerHTML
   		if(currentPage != 1){
   			getPage(1);
   		}else{
   			alert("当前页为首页");
   		}
   	}
   	
   	function previousPage(){
   		var currentPage = document.getElementById("currentPage").innerHTML
   		if(currentPage == 1){
   			alert("当前页为第一页");
   		}else{
   			var pg = currentPage-1;
   			getPage(pg);
   		}
   	}
   	
   	function nextPage(){
   		var currentPage = document.getElementById("currentPage").innerHTML
   		var pageSize = document.getElementById("pageSize").value
   		if(currentPage == pageSize){
   			alert("当前页为最后一页");
   		}else{
   			var pg = +currentPage+1;
   			getPage(pg);
   		}
   	}
   	
   	function endPage(){
   		var currentPage = document.getElementById("currentPage").innerHTML
   		var pageSize = document.getElementById("pageSize").value
   		if(currentPage == pageSize){
   			alert("当前页为最后一页");
   		}else{
   			getPage(pageSize);
   		}
   	}
    
    </script>
</head>
<body onload="getPage(1)">
 
<div id="Title_bar">
    <div id="Title_bar_Head">
        <div id="Title_Head"></div>
        <div id="Title"><!--页面标题-->
            <img border="0" width="13" height="13" src="../../style/images/title_arrow.gif"/> 待审批违规列表
        </div>
        <div id="Title_End"></div>
    </div>
</div>

<div id="MainArea">
    <table cellspacing="0" cellpadding="0" class="TableStyle">
       
        <!-- 表头-->
        <thead>
            <tr align=center valign=middle id=TableTitle>
                <td width="120px">案件id</td>
                <td width="300px">案件案由</td>
                <td width="300px">案件描述</td>
                <td width="100px">操作</td>
            </tr>
        </thead>

		<!--显示数据列表-->
        <tbody id="TableData" class="dataContainer" datakey="departmentList">
			<tr class='TableDetail1 template'>
			</tr> 
        </tbody>
    </table>
</div>
<br>
    <table id="paging" style="width: 400px" align="center">
    <tr style="height: 60px">
        <td><input type="button" name="firtPage" value="首页" onclick="firstPage()"></td>
        <td><input type="button" name="previousPage" value="上一页" onclick="previousPage()"></td>
        <td>当前页码:第<span id="currentPage"></span>页
        <td><input type="button" name="nextPage" value="下一页" onclick="nextPage()"></td>
        <td><input type="button" name="endPage" value="尾页" onclick="endPage()">
        <span id="pageSize"></span></td>
        
    </tr>
</table>
</body>
</html>
